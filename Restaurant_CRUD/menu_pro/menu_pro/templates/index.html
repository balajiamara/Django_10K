<!-- <!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <title>Menu Items</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 40px; }
        h1 { text-align: center; }
        .menu-container { display: grid; grid-template-columns: repeat(auto-fill, minmax(270px, 1fr)); gap: 20px; }
        .card { border: 1px solid #ccc; padding: 15px; border-radius: 8px; box-shadow: 0 0 5px rgba(0,0,0,0.1); }
        img { width: 100%; height: 180px; object-fit: cover; border-radius: 6px; }
        input, button { margin: 5px 0; padding: 8px; width: 100%; }
        .form-section { margin-bottom: 40px; border: 1px solid #ddd; padding: 15px; border-radius: 6px; }
    </style>
</head>
<body>

    <h1>Menu Items</h1> -->

    <!-- ADD DISH FORM -->
    <!-- <div class="form-section">
        <h2>Add Dish</h2>
        <input type="text" id="dishId" placeholder="Dish ID" />
        <input type="text" id="dishName" placeholder="Dish Name" />
        <input type="text" id="ingredients" placeholder="Ingredients" />
        <input type="number" id="price" placeholder="Price" />
        <input type="file" id="image" accept="image/*" />
        <button onclick="addDish()">Add Dish</button>
    </div>

    <h2>Available Menu</h2>
    <div class="menu-container" id="menuList"></div>

<script>
    const API_BASE_URL = "http://127.0.0.1:8000/";  // Django root

    // Fetch & Display Menu Items
    async function loadMenu() {
        const res = await fetch(API_BASE_URL + "show_item/");
        const data = await res.json();

        const container = document.getElementById("menuList");
        container.innerHTML = "";

        data.Menu_card.forEach(item => {
            container.innerHTML += `
                <div class="card">
                    <img src="${item.Image}" alt="Dish Image">
                    <h3>${item.DishName}</h3>
                    <p><strong>Ingredients:</strong> ${item.Ingredients}</p>
                    <p><strong>Price:</strong> ₹${item.Price}</p>
                    <button onclick="deleteDish('${item.DishId}')">Delete</button>
                    <button onclick="updateDishPrompt('${item.DishId}')">Update</button>
                </div>
            `;
        });
    }

    loadMenu(); -->
<!-- 
    // Add a new dish
    async function addDish() {
        const formData = new FormData();
        formData.append("DishId", document.getElementById("dishId").value);
        formData.append("DishName", document.getElementById("dishName").value);
        formData.append("Ingredients", document.getElementById("ingredients").value);
        formData.append("Price", document.getElementById("price").value);
        formData.append("Image", document.getElementById("image").files[0]);

        const res = await fetch(API_BASE_URL + "add_item/", {
            method: "POST",
            body: formData
        });

        const result = await res.json();
        alert(result.msg || JSON.stringify(result));
        loadMenu();
    }

    // Delete dish
    async function deleteDish(id) {
        if (!confirm("Are you sure?")) return;

        const res = await fetch(API_BASE_URL + "remove_item/" + id + "/", {
            method: "DELETE"
        });

        const result = await res.json().catch(()=>({Message:"Deleted"}));
        alert(result.Message || "Deleted Successfully");
        loadMenu();
    }

    // Update Dish (Prompt Version)
    function updateDishPrompt(id) {
        const name = prompt("Enter new name:");
        const ing = prompt("Enter new ingredients:");
        const price = prompt("Enter new price:");
        updateDish(id, name, ing, price);
    }

    async function updateDish(id, name, ingredients, price) {
        const formData = new FormData();
        if (name) formData.append("DishName", name);
        if (ingredients) formData.append("Ingredients", ingredients);
        if (price) formData.append("Price", price);

        const res = await fetch(API_BASE_URL + "modify_item/" + id + "/", {
            method: "PUT",
            body: formData
        });

        const result = await res.json();
        alert(result.Message || JSON.stringify(result));
        loadMenu();
    }

</script>

</body>
</html> -->


<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <title>Menu Items</title>
    <style>
        body { 
        font-family: Arial, 
        sans-serif; margin: 40px; 
        }
        h1 { 
        text-align: center; 
        }
        .menu-container { 
        display: grid; 
        grid-template-columns: repeat(auto-fill, minmax(270px, 1fr)); 
        gap: 20px; 
        }
        .card { 
        border: 1px solid #ccc; 
        padding: 15px; 
        border-radius: 8px; 
        box-shadow: 0 0 5px rgba(0,0,0,0.1); 
        }
        img { 
        width: 100%; 
        height: 180px; 
        object-fit: cover; 
        border-radius: 6px; 
        }
        input, button { 
        margin: 5px 0; 
        padding: 8px; 
        width: 100%; 
        }
        .form-section { 
        margin-bottom: 40px; 
        border: 1px solid #ddd; 
        padding: 15px; 
        border-radius: 6px; 
        }
    </style>
</head>
<body>

    <h1>Menu Items</h1>

    <div class="form-section">
        <h2>Add Dish</h2>
        <input type="text" id="dishId" placeholder="Dish ID" />
        <input type="text" id="dishName" placeholder="Dish Name" />
        <input type="text" id="ingredients" placeholder="Ingredients" />
        <input type="number" id="price" placeholder="Price" />
        <input type="file" id="image" accept="image/*" />
        <button onclick="addDish()">Add Dish</button>
    </div>

    <h2>Available Menu</h2>
    <div class="menu-container" id="menuList"></div>

<script>
    // Use the Render deployment URL
    const API_BASE_URL = "https://restaurant-menu-4z3p.onrender.com/";

    // Fetch & Display Menu Items
    async function loadMenu() {
        try {
            const res = await fetch(API_BASE_URL + "show_item/");
            if (!res.ok) throw new Error("Failed to fetch menu: " + res.status);
            const data = await res.json();

            const container = document.getElementById("menuList");
            container.innerHTML = "";

            data.Menu_card.forEach(item => {
                container.innerHTML += `
                    <div class="card">
                        <img src="${item.Image}" alt="Dish Image">
                        <h3>${item.DishName}</h3>
                        <p><strong>Ingredients:</strong> ${item.Ingredients}</p>
                        <p><strong>Price:</strong> ₹${item.Price}</p>
                        <button onclick="deleteDish('${item.DishId}')">Delete</button>
                        <button onclick="updateDishPrompt('${item.DishId}')">Update</button>
                    </div>
                `;
            });
        } catch (err) {
            console.error("Error loading menu:", err);
            alert("Could not load menu items.");
        }
    }

    loadMenu();

    // Add a new dish
    async function addDish() {
        const formData = new FormData();
        formData.append("DishId", document.getElementById("dishId").value);
        formData.append("DishName", document.getElementById("dishName").value);
        formData.append("Ingredients", document.getElementById("ingredients").value);
        formData.append("Price", document.getElementById("price").value);
        formData.append("Image", document.getElementById("image").files[0]);

        try {
            const res = await fetch(API_BASE_URL + "add_item/", {
                method: "POST",
                body: formData
            });
            const result = await res.json();
            alert(result.msg || JSON.stringify(result));
            loadMenu();
        } catch (err) {
            console.error("Error adding dish:", err);
            alert("Could not add dish.");
        }
    }

    // Delete dish
    async function deleteDish(id) {
        if (!confirm("Are you sure you want to delete this dish?")) return;

        try {
            const res = await fetch(API_BASE_URL + "remove_item/" + id + "/", {
                method: "DELETE"
            });
            const result = await res.json().catch(() => ({}));
            alert(result.Message || "Deleted Successfully");
            loadMenu();
        } catch (err) {
            console.error("Error deleting dish:", err);
            alert("Could not delete dish.");
        }
    }

    // Update Dish (Prompt version)
    function updateDishPrompt(id) {
        const name = prompt("Enter new name:");
        const ing = prompt("Enter new ingredients:");
        const price = prompt("Enter new price:");
        updateDish(id, name, ing, price);
    }

    async function updateDish(id, name, ingredients, price) {
        const formData = new FormData();
        if (name) formData.append("DishName", name);
        if (ingredients) formData.append("Ingredients", ingredients);
        if (price) formData.append("Price", price);

        try {
            const res = await fetch(API_BASE_URL + "modify_item/" + id + "/", {
                method: "PUT",
                body: formData
            });
            const result = await res.json();
            alert(result.Message || JSON.stringify(result));
            loadMenu();
        } catch (err) {
            console.error("Error updating dish:", err);
            alert("Could not update dish.");
        }
    }
</script>

</body>
</html>
